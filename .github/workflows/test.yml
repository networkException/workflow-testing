name: Build ungoogled-chromium-archlinux for testing
on: [push, pull_request]

jobs:
    a:
        runs-on: ubuntu-latest
        steps:
            - name: Output finished
              run: echo '${{ join(needs.*.outputs.finished) }}'
            - name: Check finished
              run: if [[ "${{ join(needs.*.outputs.finished) }}" == "yes" ]]; then exit 0; fi
            - name: Output needs
              run: echo '${{ toJSON(needs) }}'
            - name: Set variables
              id: variables
              run: echo "::set-output name=finished::no"
        outputs:
            finished: "${{ steps.variables.outputs.finished }}"
    
    b:
        runs-on: ubuntu-latest
        needs: "a"
        steps:
            - name: Output finished
              run: echo '${{ join(needs.*.outputs.finished) }}'
            - name: Check finished
              run: if [[ "${{ join(needs.*.outputs.finished) }}" == "yes" ]]; then exit 0; fi
            - name: Output needs
              run: echo '${{ toJSON(needs) }}'
            - name: Set variables
              id: variables
              run: echo "::set-output name=finished::true"
        outputs:
            finished: "${{ steps.variables.outputs.finished }}"

    c:
        runs-on: ubuntu-latest
        needs: "b"
        if: join(needs.*.outputs.finished)
        steps:
            - name: Output finished
              run: echo '${{ join(needs.*.outputs.finished) }}'
            - name: Check finished
              run: if [[ "${{ join(needs.*.outputs.finished) }}" == "yes" ]]; then exit 0; fi
            - name: Output needs
              run: echo '${{ toJSON(needs) }}'
            - name: Set variables
              id: variables
              run: echo "::set-output name=finished::yes"
        outputs:
            finished: "${{ steps.variables.outputs.finished }}"

    d:
        runs-on: ubuntu-latest
        needs: "c"
        steps:
            - name: Output finished
              run: echo '${{ join(needs.*.outputs.finished) }}'
            - name: Check finished
              run: if [[ "${{ join(needs.*.outputs.finished) }}" == "yes" ]]; then exit 0; fi
            - name: Output needs
              run: echo '${{ toJSON(needs) }}'
            - name: Set variables
              id: variables
              run: echo "::set-output name=finished::yes"
        outputs:
            finished: "${{ steps.variables.outputs.finished }}"
